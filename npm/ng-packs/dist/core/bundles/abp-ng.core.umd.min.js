!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/router"),require("@ngxs/store"),require("rxjs"),require("@angular/common/http"),require("rxjs/operators"),require("snq"),require("angular-oauth2-oidc"),require("@ngxs/router-plugin"),require("@angular/common"),require("@angular/forms"),require("@ngxs/storage-plugin"),require("@ngx-validate/core")):"function"==typeof define&&define.amd?define("@abp/ng.core",["exports","@angular/core","@angular/router","@ngxs/store","rxjs","@angular/common/http","rxjs/operators","snq","angular-oauth2-oidc","@ngxs/router-plugin","@angular/common","@angular/forms","@ngxs/storage-plugin","@ngx-validate/core"],e):e(((t=t||self).abp=t.abp||{},t.abp.ng=t.abp.ng||{},t.abp.ng.core={}),t.ng.core,t.ng.router,t.store,t.rxjs,t.ng.common.http,t.rxjs.operators,t.snq,t.angularOauth2Oidc,t.routerPlugin,t.ng.common,t.ng.forms,t.storagePlugin,t.core$1)}(this,function(exports,core,router,store,rxjs,http,operators,snq,angularOauth2Oidc,routerPlugin,common,forms,storagePlugin,core$1){"use strict";snq=snq&&snq.hasOwnProperty("default")?snq.default:snq;var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function __extends(t,e){function r(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var __assign=function(){return(__assign=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function __rest(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function __decorate(t,e,r,n){var o,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(i<3?o(a):i>3?o(e,r,a):o(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a}function __param(t,e){return function(r,n){e(r,n,t)}}function __metadata(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function __awaiter(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function c(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(a,c)}u((n=n.apply(t,e||[])).next())})}function __generator(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}function __exportStar(t,e){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}function __values(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}function __read(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function __spread(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(__read(arguments[e]));return t}function __spreadArrays(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var i=arguments[e],a=0,c=i.length;a<c;a++,o++)n[o]=i[a];return n}function __await(t){return this instanceof __await?(this.v=t,this):new __await(t)}function __asyncGenerator(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(t,e||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(t){o[t]&&(n[t]=function(e){return new Promise(function(r,n){i.push([t,e,r,n])>1||c(t,e)})})}function c(t,e){try{(r=o[t](e)).value instanceof __await?Promise.resolve(r.value.v).then(u,s):p(i[0][2],r)}catch(t){p(i[0][3],t)}var r}function u(t){c("next",t)}function s(t){c("throw",t)}function p(t,e){t(e),i.shift(),i.length&&c(i[0][0],i[0][1])}}function __asyncDelegator(t){var e,r;return e={},n("next"),n("throw",function(t){throw t}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,o){e[n]=t[n]?function(e){return(r=!r)?{value:__await(t[n](e)),done:"return"===n}:o?o(e):e}:o}}function __asyncValues(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise(function(n,o){(function(t,e,r,n){Promise.resolve(n).then(function(e){t({value:e,done:r})},e)})(n,o,(e=t[r](e)).done,e.value)})}}}function __makeTemplateObject(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function __importStar(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function __importDefault(t){return t&&t.__esModule?t:{default:t}}var PatchRouteByName=function(){function t(t,e){this.name=t,this.newValue=e}return t.type="[Config] Patch Route By Name",t}();var GetAppConfiguration=function(){function t(){}return t.type="[Config] Get App Configuration",t}();var StartLoader=function(){function t(t){this.payload=t}return t.type="[Loader] Start",t}();var StopLoader=function(){function t(t){this.payload=t}return t.type="[Loader] Stop",t}();var GetProfile=function(){function t(){}return t.type="[Profile] Get",t}();var UpdateProfile=function(){function t(t){this.payload=t}return t.type="[Profile] Update",t}();var ChangePassword=function(){function t(t){this.payload=t}return t.type="[Profile] Change Password",t}();var RestOccurError=function(){function t(t){this.payload=t}return t.type="[Rest] Error",t}();var SetLanguage=function(){function t(t){this.payload=t}return t.type="[Session] Set Language",t}();var SetTenant=function(){function t(t){this.payload=t}return t.type="[Session] Set Tenant",t}();var RestService=function(){function t(t,e){this.http=t,this.store=e}return t.prototype.handleError=function(t){return this.store.dispatch(new RestOccurError(t)),console.error(t),rxjs.NEVER},t.prototype.request=function(t,e,r){var n=this;void 0===e&&(e={});var o=e.observe,i=void 0===o?"body":o,a=e.throwErr,c=r||this.store.selectSnapshot(ConfigState.getApiUrl())+t.url,u=t.method,s=__rest(t,["method"]);return this.http.request(u,c,__assign({observe:i},s)).pipe("body"===i?operators.take(1):null,operators.catchError(function(t){return a?rxjs.throwError(t):n.handleError(t)}))},t.decorators=[{type:core.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:http.HttpClient},{type:store.Store}]},t.ngInjectableDef=core.ɵɵdefineInjectable({factory:function(){return new t(core.ɵɵinject(http.HttpClient),core.ɵɵinject(store.Store))},token:t,providedIn:"root"}),t}();var ProfileService=function(){function t(t){this.rest=t}return t.prototype.get=function(){return this.rest.request({method:"GET",url:"/api/identity/my-profile"})},t.prototype.update=function(t){var e={method:"PUT",url:"/api/identity/my-profile",body:t};return this.rest.request(e)},t.prototype.changePassword=function(t,e){void 0===e&&(e=!1);var r={method:"POST",url:"/api/identity/my-profile/change-password",body:t};return this.rest.request(r,{throwErr:e})},t.decorators=[{type:core.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:RestService}]},t.ngInjectableDef=core.ɵɵdefineInjectable({factory:function(){return new t(core.ɵɵinject(RestService))},token:t,providedIn:"root"}),t}();var ProfileState=function(){function t(t){this.profileService=t}return t.getProfile=function(t){return t.profile},t.prototype.profileGet=function(t){var e=t.patchState;return this.profileService.get().pipe(operators.tap(function(t){return e({profile:t})}))},t.prototype.profileUpdate=function(t,e){var r=t.patchState,n=e.payload;return this.profileService.update(n).pipe(operators.tap(function(t){return r({profile:t})}))},t.prototype.changePassword=function(t,e){var r=e.payload;return this.profileService.changePassword(r,!0)},__decorate([store.Action(GetProfile),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",void 0)],t.prototype,"profileGet",null),__decorate([store.Action(UpdateProfile),__metadata("design:type",Function),__metadata("design:paramtypes",[Object,UpdateProfile]),__metadata("design:returntype",void 0)],t.prototype,"profileUpdate",null),__decorate([store.Action(ChangePassword),__metadata("design:type",Function),__metadata("design:paramtypes",[Object,ChangePassword]),__metadata("design:returntype",void 0)],t.prototype,"changePassword",null),__decorate([store.Selector(),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Object)],t,"getProfile",null),t=__decorate([store.State({name:"ProfileState",defaults:{}}),__metadata("design:paramtypes",[ProfileService])],t)}();var ApplicationConfigurationService=function(){function t(t){this.rest=t}return t.prototype.getConfiguration=function(){return this.rest.request({method:"GET",url:"/api/abp/application-configuration"})},t.decorators=[{type:core.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:RestService}]},t.ngInjectableDef=core.ɵɵdefineInjectable({factory:function(){return new t(core.ɵɵinject(RestService))},token:t,providedIn:"root"}),t}();var SessionState=function(){function t(){}return t.getLanguage=function(t){return t.language},t.getTenant=function(t){return t.tenant},t.prototype.setLanguage=function(t,e){(0,t.patchState)({language:e.payload})},t.prototype.setTenantId=function(t,e){(0,t.patchState)({tenant:e.payload})},__decorate([store.Action(SetLanguage),__metadata("design:type",Function),__metadata("design:paramtypes",[Object,SetLanguage]),__metadata("design:returntype",void 0)],t.prototype,"setLanguage",null),__decorate([store.Action(SetTenant),__metadata("design:type",Function),__metadata("design:paramtypes",[Object,SetTenant]),__metadata("design:returntype",void 0)],t.prototype,"setTenantId",null),__decorate([store.Selector(),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",String)],t,"getLanguage",null),__decorate([store.Selector(),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Object)],t,"getTenant",null),t=__decorate([store.State({name:"SessionState",defaults:{}}),__metadata("design:paramtypes",[])],t)}();function organizeRoutes(t,e,r,n){void 0===e&&(e=[]),void 0===r&&(r=[]),void 0===n&&(n=null);var o=function(t){return t.children&&t.children.length&&(t.children=organizeRoutes(t.children,e,r,t.name)),!t.parentName||t.parentName===n||(r.push(t),!1)};if(n)return t.filter(o);var i=t.filter(o);return r.length?sortRoutes(setChildRoute(__spread(i,e),r)):i}function setChildRoute(t,e){return t.map(function(t){t.children&&t.children.length&&(t.children=setChildRoute(t.children,e));var r=e.filter(function(e){return e.parentName===t.name});return r&&r.length&&(t.children=__spread(t.children||[],r)),t})}function sortRoutes(t){return void 0===t&&(t=[]),t.length?t.sort(function(t,e){return t.order-e.order}).map(function(t){return t.children&&t.children.length&&(t.children=sortRoutes(t.children)),t}):[]}var ConfigState=function(){function ConfigState(t,e){this.appConfigurationService=t,this.store=e}var ConfigState_1;return ConfigState_1=ConfigState,ConfigState.getAll=function(t){return t},ConfigState.getApplicationInfo=function(t){return t.environment.application||{}},ConfigState.getOne=function(t){return store.createSelector([ConfigState_1],function(e){return e[t]})},ConfigState.getDeep=function(t){if("string"==typeof t&&(t=t.split(".")),!Array.isArray(t))throw new Error("The argument must be a dot string or an string array.");return store.createSelector([ConfigState_1],function(e){return t.reduce(function(t,e){if(t)return t[e]},e)})},ConfigState.getApiUrl=function(t){return store.createSelector([ConfigState_1],function(e){return e.environment.apis[t||"default"].url})},ConfigState.getSetting=function(t){return store.createSelector([ConfigState_1],function(e){return snq(function(){return e.setting.values[t]})})},ConfigState.getGrantedPolicy=function(condition){void 0===condition&&(condition="");var keys=condition.replace(/\(|\)|\!|\s/g,"").split(/\|\||&&/).filter(function(t){return t}),selector=store.createSelector([ConfigState_1],function(state){if(!keys.length)return!0;var getPolicy=function(t){return snq(function(){return state.auth.grantedPolicies[t]},!1)};return keys.length>1?(keys.forEach(function(t){var e=getPolicy(t);condition=condition.replace(t,e)}),eval("!!"+condition)):getPolicy(condition)});return selector},ConfigState.getCopy=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];t||(t="");var n=t.split("::"),o=store.createSelector([ConfigState_1],function(r){if(!r.localization)return t;var o=r.environment.localization.defaultResourceName;if(""===n[0]){if(!o)throw new Error("Please check your environment. May you forget set defaultResourceName? \n              Here is the example:\n               { production: false,\n                 localization: {\n                   defaultResourceName: 'MyProjectName'\n                  }\n               }");n[0]=snq(function(){return o})}var i=n.reduce(function(t,e){if(t)return t[e]},r.localization.values);return e=e.filter(function(t){return null!=t}),i&&e&&e.length&&e.forEach(function(t){i=i.replace(/[\'\"]?\{[\d]+\}[\'\"]?/,t)}),i||t});return o},ConfigState.prototype.addData=function(t){var e=this,r=t.patchState,n=t.dispatch;return this.appConfigurationService.getConfiguration().pipe(operators.tap(function(t){return r(__assign({},t))}),operators.switchMap(function(t){return e.store.selectSnapshot(SessionState.getLanguage)?rxjs.of(null):n(new SetLanguage(snq(function(){return t.setting.values["Abp.Localization.DefaultLanguage"]})))}))},ConfigState.prototype.patchRoute=function(t,e){var r=t.patchState,n=t.getState,o=e.name,i=e.newValue,a=n().routes;a.findIndex(function(t){return t.name===o});return r({routes:a=patchRouteDeep(a,o,i)})},__decorate([store.Action(GetAppConfiguration),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",void 0)],ConfigState.prototype,"addData",null),__decorate([store.Action(PatchRouteByName),__metadata("design:type",Function),__metadata("design:paramtypes",[Object,PatchRouteByName]),__metadata("design:returntype",void 0)],ConfigState.prototype,"patchRoute",null),__decorate([store.Selector(),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",void 0)],ConfigState,"getAll",null),__decorate([store.Selector(),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",void 0)],ConfigState,"getApplicationInfo",null),ConfigState=ConfigState_1=__decorate([store.State({name:"ConfigState",defaults:{}}),__metadata("design:paramtypes",[ApplicationConfigurationService,store.Store])],ConfigState),ConfigState}();function patchRouteDeep(t,e,r,n){return void 0===n&&(n=null),t=t.map(function(t){return t.name===e?(r.path&&(r.url=n+"/"+r.path),r.children&&r.children.length&&(r.children=r.children.map(function(e){return __assign({},e,{url:n+"/"+t.path+"/"+e.path})})),__assign({},t,r)):(t.children&&t.children.length&&(t.children=patchRouteDeep(t.children,e,r,(n||"/")+t.path)),t)}),n?t:organizeRoutes(t)}function uuid(t){return t?(t^16*Math.random()>>t/4).toString(16):(""+1e7+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,uuid)}function getInitialData(t){return function(){return t.get(store.Store).dispatch(new GetAppConfiguration).toPromise()}}function isFunction(t){return"function"==typeof t}var takeUntilDestroy=function(t,e){return void 0===e&&(e="ngOnDestroy"),function(r){var n=t[e];if(!1===isFunction(n))throw new Error(t.constructor.name+" is using untilDestroyed but doesn't implement "+e);return t.__takeUntilDestroy||(t.__takeUntilDestroy=new rxjs.Subject,t[e]=function(){isFunction(n)&&n.apply(this,arguments),t.__takeUntilDestroy.next(!0),t.__takeUntilDestroy.complete()}),r.pipe(operators.takeUntil(t.__takeUntilDestroy))}},DynamicLayoutComponent=function(){function t(t,e){var r=this;this.router=t,this.store=e,this.router.events.pipe(takeUntilDestroy(this)).subscribe(function(t){if(t instanceof router.NavigationEnd){var e=r.router.parseUrl(t.url).root.children.primary.segments,n=r.store.selectSnapshot(ConfigState.getAll),o=n.requirements.layouts,i=findLayout(e,n.routes);r.layout=o.filter(function(t){return!!t}).find(function(t){return snq(function(){return t.type.toLowerCase().indexOf(i)},-1)>-1})}})}return t.prototype.ngOnDestroy=function(){},t.decorators=[{type:core.Component,args:[{selector:"abp-dynamic-layout",template:'\n    <ng-container *ngTemplateOutlet="layout ? componentOutlet : routerOutlet"></ng-container>\n\n    <ng-template #routerOutlet><router-outlet></router-outlet></ng-template>\n    <ng-template #componentOutlet><ng-container *ngComponentOutlet="layout"></ng-container></ng-template>\n  '}]}],t.ctorParameters=function(){return[{type:router.Router},{type:store.Store}]},__decorate([store.Select(ConfigState.getOne("requirements")),__metadata("design:type",rxjs.Observable)],t.prototype,"requirements$",void 0),t}();function findLayout(t,e){var r="empty",n=e.reduce(function(t,e){return e.wrapper?__spread(t,e.children):__spread(t,[e])},[]).find(function(e){return e.path===t[0].path});if(n&&(n.layout&&(r=n.layout),n.children&&n.children.length&&t.length>1)){var o=n.children.find(function(e){return e.path===t[1].path});o.layout&&(r=o.layout)}return r}var RouterOutletComponent=function(){function t(){}return t.decorators=[{type:core.Component,args:[{selector:"abp-router-outlet",template:"\n    <router-outlet></router-outlet>\n  "}]}],t}(),AutofocusDirective=function(){function t(t){this.elRef=t,this.delay=0}return t.prototype.ngAfterViewInit=function(){var t=this;setTimeout(function(){return t.elRef.nativeElement.focus()},this.delay)},t.decorators=[{type:core.Directive,args:[{selector:"[autofocus]"}]}],t.ctorParameters=function(){return[{type:core.ElementRef}]},t.propDecorators={delay:[{type:core.Input,args:["autofocus"]}]},t}();var EllipsisDirective=function(){function t(t,e){this.cdRef=t,this.elRef=e,this.enabled=!0}return Object.defineProperty(t.prototype,"class",{get:function(){return this.enabled},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxWidth",{get:function(){return this.enabled?this.width||"170px":void 0},enumerable:!0,configurable:!0}),t.prototype.ngAfterContentInit=function(){var t=this;setTimeout(function(){var e=t.title;t.title=e||t.elRef.nativeElement.innerText,t.title!==e&&t.cdRef.detectChanges()},0)},t.decorators=[{type:core.Directive,args:[{selector:"[abpEllipsis]"}]}],t.ctorParameters=function(){return[{type:core.ChangeDetectorRef},{type:core.ElementRef}]},t.propDecorators={width:[{type:core.Input,args:["abpEllipsis"]}],title:[{type:core.HostBinding,args:["title"]},{type:core.Input}],enabled:[{type:core.Input,args:["abpEllipsisEnabled"]}],class:[{type:core.HostBinding,args:["class.abp-ellipsis"]}],maxWidth:[{type:core.HostBinding,args:["style.max-width"]}]},t}();var PermissionDirective=function(){function t(t,e,r){this.elRef=t,this.renderer=e,this.store=r}return t.prototype.ngOnInit=function(){var t=this;this.condition&&this.store.select(ConfigState.getGrantedPolicy(this.condition)).pipe(takeUntilDestroy(this)).subscribe(function(e){e||t.renderer.removeChild(t.elRef.nativeElement.parentElement,t.elRef.nativeElement)})},t.prototype.ngOnDestroy=function(){},t.decorators=[{type:core.Directive,args:[{selector:"[abpPermission]"}]}],t.ctorParameters=function(){return[{type:core.ElementRef,decorators:[{type:core.Optional}]},{type:core.Renderer2},{type:store.Store}]},t.propDecorators={condition:[{type:core.Input,args:["abpPermission"]}]},t}();var VisibilityDirective=function(){function t(t,e){this.elRef=t,this.renderer=e,this.completed$=new rxjs.Subject}return t.prototype.ngAfterViewInit=function(){var t=this,e=new MutationObserver(function(e){e.forEach(function(e){e.target&&(snq(function(){return Array.from(e.target.childNodes).filter(function(t){return t instanceof HTMLElement})},[]).length?setTimeout(function(){t.disconnect()},0):(t.renderer.removeChild(t.elRef.nativeElement.parentElement,t.elRef.nativeElement),t.disconnect()))})});e.observe(this.focusedElement,{childList:!0}),this.completed$.subscribe(function(){return e.disconnect()})},t.prototype.disconnect=function(){this.completed$.next(),this.completed$.complete()},t.decorators=[{type:core.Directive,args:[{selector:"[abpVisibility]"}]}],t.ctorParameters=function(){return[{type:core.ElementRef,decorators:[{type:core.Optional}]},{type:core.Renderer2}]},t.propDecorators={focusedElement:[{type:core.Input,args:["abpVisibility"]}]},t}();var eLayoutType={account:"account",application:"application",empty:"empty"},AuthGuard=function(){function t(t,e){this.oauthService=t,this.store=e}return t.prototype.canActivate=function(t,e){var r=this.oauthService.hasValidAccessToken();return r||(this.store.dispatch(new routerPlugin.Navigate(["/account/login"],null,{state:{redirectUrl:e.url}})),!1)},t.decorators=[{type:core.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:angularOauth2Oidc.OAuthService},{type:store.Store}]},t.ngInjectableDef=core.ɵɵdefineInjectable({factory:function(){return new t(core.ɵɵinject(angularOauth2Oidc.OAuthService),core.ɵɵinject(store.Store))},token:t,providedIn:"root"}),t}();var PermissionGuard=function(){function t(t){this.store=t}return t.prototype.canActivate=function(t){var e=t.data.requiredPolicy;return this.store.select(ConfigState.getGrantedPolicy(e))},t.decorators=[{type:core.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:store.Store}]},t.ngInjectableDef=core.ɵɵdefineInjectable({factory:function(){return new t(core.ɵɵinject(store.Store))},token:t,providedIn:"root"}),t}();var ApiInterceptor=function(){function t(t,e){this.oAuthService=t,this.store=e}return t.prototype.intercept=function(t,e){var r=this;this.store.dispatch(new StartLoader(t));var n={},o=this.oAuthService.getAccessToken();!t.headers.has("Authorization")&&o&&(n.Authorization="Bearer "+o);var i=this.store.selectSnapshot(SessionState.getLanguage);!t.headers.has("Accept-Language")&&i&&(n["Accept-Language"]=i);var a=this.store.selectSnapshot(SessionState.getTenant);return!t.headers.has("__tenant")&&a&&(n.__tenant=a.id),e.handle(t.clone({setHeaders:n})).pipe(operators.finalize(function(){return r.store.dispatch(new StopLoader(t))}))},t.decorators=[{type:core.Injectable}],t.ctorParameters=function(){return[{type:angularOauth2Oidc.OAuthService},{type:store.Store}]},t}(),ApplicationConfiguration,ABP,Config,Session,Profile;(function(t){function e(){}function r(){}function n(){}function o(){}function i(){}function a(){}function c(){}t.Response=e,t.Localization=r,t.LocalizationValue=function(){},t.Language=n,t.Auth=o,t.Policy=function(){},t.Setting=i,t.CurrentUser=a,t.Features=c})(ApplicationConfiguration||(ApplicationConfiguration={})),function(t){function e(){}function r(){}function n(){}function o(){}function i(){}function a(){}t.Root=e,t.PagedItemsResponse=r,t.PageQueryParams=n,t.Route=o,t.FullRoute=i,t.BasicItem=a}(ABP||(ABP={})),function(t){function e(){}function r(){}function n(){}t.State=function(){},t.Environment=e,t.Application=r,t.Apis=function(){},t.Requirements=n}(Config||(Config={})),function(t){function e(){}function r(){}t.Config=e,t.Request=r}(exports.Rest||(exports.Rest={})),function(t){function e(){}t.State=e}(Session||(Session={})),function(t){function e(){}function r(){}function n(){}t.State=e,t.Response=r,t.ChangePasswordRequest=n}(Profile||(Profile={}));var NGXS_CONFIG_PLUGIN_OPTIONS=new core.InjectionToken("NGXS_CONFIG_PLUGIN_OPTIONS"),ConfigPlugin=function(){function t(t,e){this.options=t,this.router=e,this.initialized=!1}return t.prototype.handle=function(t,e,r){var n=store.actionMatcher(e);if((n(store.InitState)||n(store.UpdateState))&&!this.initialized){var o=transformRoutes(this.router.config),i=o.routes;i=organizeRoutes(i,o.wrappers),t=store.setValue(t,"ConfigState",__assign({},t.ConfigState&&__assign({},t.ConfigState),this.options,{routes:i})),this.initialized=!0}return r(t,e)},t.decorators=[{type:core.Injectable}],t.ctorParameters=function(){return[{type:void 0,decorators:[{type:core.Inject,args:[NGXS_CONFIG_PLUGIN_OPTIONS]}]},{type:router.Router}]},t}();function transformRoutes(t,e){void 0===t&&(t=[]),void 0===e&&(e=[]);var r=t.filter(function(t){return snq(function(){return t.data.routes.find(function(e){return e.path===t.path})},!1)}).reduce(function(t,e){return __spread(t,e.data.routes)},[]);e=r.filter(function(t){return t.wrapper});var n=[];return t.filter(function(t){return(t.data||{}).routes&&(t.component||t.loadChildren)}).forEach(function(t){var e=r.find(function(e){return e.path.toLowerCase()===t.path.toLowerCase()&&snq(function(){return t.data.routes.length},!1)}),o=n.length;e&&n.push(e),n.length===o&&n.push({path:t.path,name:snq(function(){return t.data.routes.name},t.path),children:t.data.routes.children||[]})}),{routes:setUrls(n),wrappers:e}}function setUrls(t,e){return e?t.map(function(t){return __assign({},t,{url:e+"/"+t.path},t.children&&t.children.length&&{children:setUrls(t.children,e+"/"+t.path)})}):t.map(function(t){return __assign({},t,{url:"/"+t.path},t.children&&t.children.length&&{children:setUrls(t.children,"/"+t.path)})})}var ConfigService=function(){function t(t){this.store=t}return t.prototype.getAll=function(){return this.store.selectSnapshot(ConfigState.getAll)},t.prototype.getOne=function(t){return this.store.selectSnapshot(ConfigState.getOne(t))},t.prototype.getDeep=function(t){return this.store.selectSnapshot(ConfigState.getDeep(t))},t.prototype.getSetting=function(t){return this.store.selectSnapshot(ConfigState.getSetting(t))},t.decorators=[{type:core.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:store.Store}]},t.ngInjectableDef=core.ɵɵdefineInjectable({factory:function(){return new t(core.ɵɵinject(store.Store))},token:t,providedIn:"root"}),t}();var LazyLoadService=function(){function t(){this.loadedLibraries={}}return t.prototype.load=function(t,e,r,n,o){var i=this;if(void 0===r&&(r=""),void 0===n&&(n="body"),void 0===o&&(o="afterend"),t||r){var a,c=t?t.slice(t.lastIndexOf("/")+1):uuid();return this.loadedLibraries[c]?this.loadedLibraries[c].asObservable():(this.loadedLibraries[c]=new rxjs.ReplaySubject,"script"===e?((a=document.createElement("script")).type="text/javascript",t&&(a.src=t),a.text=r):t?((a=document.createElement("link")).type="text/css",a.rel="stylesheet",t&&(a.href=t)):(a=document.createElement("style")).textContent=r,a.onload=function(){i.loadedLibraries[c].next(),i.loadedLibraries[c].complete()},document.querySelector(n).insertAdjacentElement(o,a),this.loadedLibraries[c].asObservable())}},t.decorators=[{type:core.Injectable,args:[{providedIn:"root"}]}],t.ngInjectableDef=core.ɵɵdefineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}();var LocalizationService=function(){function t(t){this.store=t}return t.prototype.get=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return this.store.select(ConfigState.getCopy.apply(ConfigState,__spread([t],e)))},t.prototype.instant=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return this.store.selectSnapshot(ConfigState.getCopy.apply(ConfigState,__spread([t],e)))},t.decorators=[{type:core.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:store.Store}]},t.ngInjectableDef=core.ɵɵdefineInjectable({factory:function(){return new t(core.ɵɵinject(store.Store))},token:t,providedIn:"root"}),t}();function environmentFactory(t){return __assign({},t)}function configFactory(t){return __assign({},t)}var ENVIRONMENT=new core.InjectionToken("ENVIRONMENT"),CONFIG=new core.InjectionToken("CONFIG"),LocalizationPipe=function(){function t(t){this.store=t,this.initialized=!1}return t.prototype.transform=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return this.initialized||(this.initialized=!0,this.store.select(ConfigState.getCopy.apply(ConfigState,__spread([t],r.reduce(function(t,e){return Array.isArray(e)?__spread(t,e):__spread(t,[e])},[])))).pipe(takeUntilDestroy(this),operators.distinctUntilChanged()).subscribe(function(t){return e.value=t})),this.value},t.prototype.ngOnDestroy=function(){},t.decorators=[{type:core.Pipe,args:[{name:"abpLocalization",pure:!1}]}],t.ctorParameters=function(){return[{type:store.Store}]},t}();var InputEventDebounceDirective=function(){function t(t,e){this.renderer=t,this.el=e,this.debounce=300,this.debounceEvent=new core.EventEmitter}return t.prototype.ngOnInit=function(){var t=this;rxjs.fromEvent(this.el.nativeElement,"input").pipe(operators.debounceTime(this.debounce),core$1.takeUntilDestroy(this)).subscribe(function(e){t.debounceEvent.emit(e)})},t.decorators=[{type:core.Directive,args:[{selector:"[input.debounce]"}]}],t.ctorParameters=function(){return[{type:core.Renderer2},{type:core.ElementRef}]},t.propDecorators={debounce:[{type:core.Input}],debounceEvent:[{type:core.Output,args:["input.debounce"]}]},t}();var ClickEventStopPropagationDirective=function(){function t(t,e){this.renderer=t,this.el=e,this.stopPropEvent=new core.EventEmitter}return t.prototype.ngOnInit=function(){var t=this;rxjs.fromEvent(this.el.nativeElement,"click").pipe(core$1.takeUntilDestroy(this)).subscribe(function(e){e.stopPropagation(),t.stopPropEvent.emit(e)})},t.decorators=[{type:core.Directive,args:[{selector:"[click.stop]"}]}],t.ctorParameters=function(){return[{type:core.Renderer2},{type:core.ElementRef}]},t.propDecorators={stopPropEvent:[{type:core.Output,args:["click.stop"]}]},t}();var CoreModule=function(){function t(){}return t.forRoot=function(e){return void 0===e&&(e={}),{ngModule:t,providers:[{provide:store.NGXS_PLUGINS,useClass:ConfigPlugin,multi:!0},{provide:NGXS_CONFIG_PLUGIN_OPTIONS,useValue:e},{provide:http.HTTP_INTERCEPTORS,useClass:ApiInterceptor,multi:!0},{provide:core.APP_INITIALIZER,multi:!0,deps:[core.Injector],useFactory:getInitialData}]}},t.decorators=[{type:core.NgModule,args:[{imports:[store.NgxsModule.forFeature([ProfileState,SessionState,ConfigState]),storagePlugin.NgxsStoragePluginModule.forRoot({key:"SessionState"}),routerPlugin.NgxsRouterPluginModule.forRoot(),common.CommonModule,http.HttpClientModule,forms.FormsModule,forms.ReactiveFormsModule,router.RouterModule],declarations:[RouterOutletComponent,DynamicLayoutComponent,AutofocusDirective,EllipsisDirective,LocalizationPipe,PermissionDirective,VisibilityDirective,InputEventDebounceDirective,ClickEventStopPropagationDirective],exports:[common.CommonModule,http.HttpClientModule,forms.FormsModule,forms.ReactiveFormsModule,router.RouterModule,RouterOutletComponent,DynamicLayoutComponent,AutofocusDirective,EllipsisDirective,LocalizationPipe,PermissionDirective,VisibilityDirective,InputEventDebounceDirective,LocalizationPipe,ClickEventStopPropagationDirective],providers:[LocalizationPipe],entryComponents:[RouterOutletComponent,DynamicLayoutComponent]}]}],t}();exports.ApiInterceptor=ApiInterceptor,exports.ApplicationConfigurationService=ApplicationConfigurationService,exports.AuthGuard=AuthGuard,exports.AutofocusDirective=AutofocusDirective,exports.CONFIG=CONFIG,exports.ChangePassword=ChangePassword,exports.ConfigPlugin=ConfigPlugin,exports.ConfigService=ConfigService,exports.ConfigState=ConfigState,exports.CoreModule=CoreModule,exports.DynamicLayoutComponent=DynamicLayoutComponent,exports.ENVIRONMENT=ENVIRONMENT,exports.EllipsisDirective=EllipsisDirective,exports.GetAppConfiguration=GetAppConfiguration,exports.GetProfile=GetProfile,exports.LazyLoadService=LazyLoadService,exports.LocalizationService=LocalizationService,exports.NGXS_CONFIG_PLUGIN_OPTIONS=NGXS_CONFIG_PLUGIN_OPTIONS,exports.PatchRouteByName=PatchRouteByName,exports.PermissionDirective=PermissionDirective,exports.PermissionGuard=PermissionGuard,exports.ProfileService=ProfileService,exports.ProfileState=ProfileState,exports.RestOccurError=RestOccurError,exports.RestService=RestService,exports.RouterOutletComponent=RouterOutletComponent,exports.SessionState=SessionState,exports.SetLanguage=SetLanguage,exports.SetTenant=SetTenant,exports.StartLoader=StartLoader,exports.StopLoader=StopLoader,exports.UpdateProfile=UpdateProfile,exports.VisibilityDirective=VisibilityDirective,exports.configFactory=configFactory,exports.environmentFactory=environmentFactory,exports.getInitialData=getInitialData,exports.organizeRoutes=organizeRoutes,exports.setChildRoute=setChildRoute,exports.sortRoutes=sortRoutes,exports.takeUntilDestroy=takeUntilDestroy,exports.uuid=uuid,exports.ɵa=ProfileState,exports.ɵb=ProfileService,exports.ɵba=ConfigPlugin,exports.ɵbb=ApiInterceptor,exports.ɵbc=getInitialData,exports.ɵc=RestService,exports.ɵd=GetProfile,exports.ɵe=UpdateProfile,exports.ɵf=ChangePassword,exports.ɵh=SessionState,exports.ɵi=SetLanguage,exports.ɵj=SetTenant,exports.ɵl=ConfigState,exports.ɵm=ApplicationConfigurationService,exports.ɵn=PatchRouteByName,exports.ɵo=GetAppConfiguration,exports.ɵp=RouterOutletComponent,exports.ɵq=DynamicLayoutComponent,exports.ɵr=ConfigState,exports.ɵs=AutofocusDirective,exports.ɵt=EllipsisDirective,exports.ɵu=LocalizationPipe,exports.ɵv=PermissionDirective,exports.ɵw=VisibilityDirective,exports.ɵx=InputEventDebounceDirective,exports.ɵy=ClickEventStopPropagationDirective,exports.ɵz=NGXS_CONFIG_PLUGIN_OPTIONS,Object.defineProperty(exports,"__esModule",{value:!0})});
//# sourceMappingURL=abp-ng.core.umd.min.js.map